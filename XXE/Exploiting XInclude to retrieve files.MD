## Exploiting XInclude to retrieve files

> Lab này sẽ hướng dẫn chúng ta sử dụng XInclude để lấy ra nội dung file

Chúng ta lại bắt lại request checkStock

![](/imgs/XXE/31.png?raw=true)

Như ta thấy, không còn XML nữa :v

> Cho nên lab này chúng ta sẽ sử dụng XInclude trong trường hợp mình không thể thay đổi xml

Xinclude có 2 phần tử include và fallback từ namespace http://www.w3.org/2001/XInclude + 6 thuộc tính href, parse, xpointer, encoding, accept, accept-language.

> Nếu đã từng code WPF thì sẽ biết cái này :v

Còn đây là ví dụ từ w3shool

![](/imgs/XXE/32.png?raw=true)

Có 2 param để chúng ta inject vào thử

Ta sẽ inject đoạn tag như sau

```XML
<test xmlns:test="http://www.w3.org/2001/XInclude"> (Cái link là phần namespace khai báo) 
<test:include parse="text" href="file:///etc/passwd"/></test>
```

Đây là giải thích parse sang text trong XInclude

![](/imgs/XXE/33.png?raw=true)

Encode lại request là gửi đi

![](/imgs/XXE/34.png?raw=true)
![](/imgs/XXE/35.png?raw=true)

### Tài Liệu Tham Khảo
- Một số CheatSheet: [https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html](https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html)
- XInclude: [http://zvon.org/xxl/XIncludeTutorial/Output/contents.html](http://zvon.org/xxl/XIncludeTutorial/Output/contents.html)