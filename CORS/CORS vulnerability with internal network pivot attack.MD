## CORS vulnerability with internal network pivot attack

Lab đưa ra yêu cầu phải làm cách nào đó, phải delete được user là Carlos thì mới solve lab, vì thế lab có hướng dẫn xây dựng các hàm js có endpoint là 192.168.0.0/24:8080 để xác định CORS

![](/imgs/CORS/24.png?raw=true)

Chúng ta nên xem solution tham khảo thì hơn :v

Đầu tiên ta phải thực hiện gửi request tới BurpCollaborator để xác định địa chỉ gửi là bao nhiêu.

Đưa đoạn code ở step 1 vào exploit server

![](/imgs/CORS/25.png?raw=true)

Ta sẽ thay bằng url của Burp Collaborator vào để nhận request

> Địa chỉ nhận được là 192.168.0.96:8080

![](/imgs/CORS/26.png?raw=true)

Đến step 2 ta sẽ xác định XSS bằng cách send 1 function tới địa chỉ lab để xác định có xss không (nếu có sẽ request tới sẽ có dạng ***/?foundXSS=1***).

![](/imgs/CORS/27.png?raw=true)
![](/imgs/CORS/28.png?raw=true)

Step 3 ta sẽ send request chứa xss ở url /admin xem web có trả về gì ko, kết quả là trả về sourcecode của /admin.

![](/imgs/CORS/29.png?raw=true)

Đến step 4 ta sẽ chèn xss thực thi xóa user Carlos bằng cách lấy username từ form đã trả về ở step trên và submit đi.

![](/imgs/CORS/30.png?raw=true)

Sau khi delete thành công sẽ solve lab

![](/imgs/CORS/31.png?raw=true)




